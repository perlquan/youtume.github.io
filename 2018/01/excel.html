<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.lug.ustc.edu.cn/css?family=Neucha:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="excel," />





  <link rel="alternate" href="/atom.xml" title="优图米's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="excel等是数据分析中的基本工具，是每一个数据相关从业者必备的技能之一，本文从此处出发，以excel函数等为入口，系统学习excel的相关技能，力求熟练并精通之，并在此处记录。 excel技巧 填充：3种方式：①拖拽填充柄 ② 双击填充柄 ③ 填充公式：选中目标单元格区域，按Ctrl确定；然后保证在全选情况下在第一个写入公式合键或者【开始-填充】下拉按钮-向下，进行填充。 分阶段填充，选中目标区">
<meta name="keywords" content="excel">
<meta property="og:type" content="article">
<meta property="og:title" content="excel使用技巧">
<meta property="og:url" content="https://www.youtumi.cn/2018/01/excel.html">
<meta property="og:site_name" content="优图米&#39;s blog">
<meta property="og:description" content="excel等是数据分析中的基本工具，是每一个数据相关从业者必备的技能之一，本文从此处出发，以excel函数等为入口，系统学习excel的相关技能，力求熟练并精通之，并在此处记录。 excel技巧 填充：3种方式：①拖拽填充柄 ② 双击填充柄 ③ 填充公式：选中目标单元格区域，按Ctrl确定；然后保证在全选情况下在第一个写入公式合键或者【开始-填充】下拉按钮-向下，进行填充。 分阶段填充，选中目标区">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://www.youtumi.cn/img/other/text生产指定区间的日期.png">
<meta property="og:image" content="https://www.youtumi.cn/img/other/判断日期所在月份有几个星期日.png">
<meta property="og:updated_time" content="2018-03-21T02:21:08.531Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="excel使用技巧">
<meta name="twitter:description" content="excel等是数据分析中的基本工具，是每一个数据相关从业者必备的技能之一，本文从此处出发，以excel函数等为入口，系统学习excel的相关技能，力求熟练并精通之，并在此处记录。 excel技巧 填充：3种方式：①拖拽填充柄 ② 双击填充柄 ③ 填充公式：选中目标单元格区域，按Ctrl确定；然后保证在全选情况下在第一个写入公式合键或者【开始-填充】下拉按钮-向下，进行填充。 分阶段填充，选中目标区">
<meta name="twitter:image" content="https://www.youtumi.cn/img/other/text生产指定区间的日期.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"输入关键字搜索","hits_empty":"没有找到与 ${query} 相关的内容","hits_stats":"搜索到 ${hits} 条相关记录，共耗时 ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.youtumi.cn/2018/01/excel.html"/>





  <title> excel使用技巧 | 优图米's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?209ead5acf7ef7ede1674e500c4430d5";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta custom-logo">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">优图米's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <h1 class="site-subtitle" itemprop="description">优图米的个人博客</h1>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="search.placeholder" spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://www.youtumi.cn/2018/01/excel.html">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Shuangquan">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="优图米's blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="优图米's blog" src="/images/avatar.jpg">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                excel使用技巧
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-16T13:57:44+08:00">
                2018-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析基本工具/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析基本工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          
         
		<span class="post-time">
	   &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o" aria-hidden="true"></i>
           </span>
           <span class="post-meta-item-text">字数统计:</span>
           <span class="post-count">2,943 字</span>
           
         </span>
	  
      <span class="post-time">
	   &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o" aria-hidden="true"></i>
           </span>
           <span class="post-meta-item-text">阅读时长:</span>
           <span class="post-count">11 分钟</span>
           
         </span>
         </span>
          

		 
		 
          
 
        


        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>excel等是数据分析中的基本工具，是每一个数据相关从业者必备的技能之一，本文从此处出发，以excel函数等为入口，系统学习excel的相关技能，力求熟练并<strong>精通</strong>之，并在此处记录。</p>
<h4 id="excel技巧"><a href="#excel技巧" class="headerlink" title="excel技巧"></a>excel技巧</h4><ol>
<li>填充：3种方式：①拖拽填充柄 ② 双击填充柄 ③ 填充公式：选中目标单元格区域，按Ctrl确定；然后保证在全选情况下在第一个写入公式合键或者【开始-填充】下拉按钮-向下，进行填充。<ul>
<li>分阶段填充，选中目标区域，定位/Ctrl+G组合键打开，定位空值确定；然后保证在全选情况下在第一个单元格中写入公式，然后Ctrl+Enter组合键就全部分阶段填充。</li>
<li>选中：excel中选中第一个单元格按住shift然后点最后一个单元格，即可全部选中当前目标区域。如果行数太多，可以使用<strong>Ctrl+Shift+向下加方向键</strong>，直接定位到列有值的最后一行，如果在按一下向下方向键则选择全部行。Ctrl+Shift+空格选中当前表中有连续值的目标区域。</li>
</ul>
</li>
<li>引用格式： <code>[工作簿名称]工作表名!单元格引用</code></li>
<li>文本和数字转换，数字转特定格式文本：TEXT(A1,”特定格式”)或者&amp;””或者CONCATENATE函数拼接字符；文本转数字：数据-分列 选数字等格式或者X1(乘1)</li>
<li>ANSI编码：<code>CHAR(10),&amp;CHAR(10)&amp;</code>;如果要在单元格中显示出2行，可用如上拼接，然后点击开始-自动换行按钮，即可换行显示。</li>
<li>查找excel表中单元格字符，可以将该列复制到word中，查找Ctrl+H替换[!0-9]，剩下全部是数字，然后再copy至excel中。</li>
</ol>
<h4 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h4><ol>
<li>type函数：查看单元格value类型，1-数字，2-文本，4-逻辑值，16-错误值，64-数组常量；注意当单元格为空时候，type函数会将其认为是数值0处理，结果为1</li>
<li>大小写字母转换：小写—&gt;大写UPPER，大写-&gt;小写LOWER，首字母大写其余字母改为小写PROPER</li>
<li>截取字符函数：从左LEFT；从右RIGHT；从单元格任意位置截取字符串：<code>MID(text,start_num,num_chars)</code>;这3个字符都是按字符数处理;</li>
<li>对指定小数位数舍入数值：<code>FIXED(number，[decimals], [no_commas])</code>，该函数默认是2位小数；即对小数位数直接舍去；而ROUND则是根据小数位数直接四舍五入得到最后的值。</li>
<li>查找字符<code>FIND(find_test, within_text,[start_num])</code>,返回从左到右方向第一次出现的位置；不存在则返回#VALUE；SEARCH函数语法类似，不区分大小写，允许使用通配符，但是FIND区分大小写，并不允许使用通配符；</li>
<li><code>SUBSTITUTE(text,old_text,new_text,[instance_num])</code>替换字符或字符串：第一个参数text是需要替换其中字符的文本或者单元格引用，第二个参数old_text是需要替代的文本；第三个参数new_text是用于替换old_text的文本，第四个参数可选，指定要替换第几次出现的旧字符串。<br><code>REPLACE(old_text,start_num,num_chars,new_text)</code>函数-将部分文本字符串替换为不同的文本字符串:例如<code>REPLACE(B2,4,4,&quot;****&quot;)</code></li>
<li>TEXT函数：格式化文本：<code>TEXT(value, format_text)</code>;<br>format_text格式化代码：<ul>
<li>3个条件区段，并用半角分号(;)间隔;如下：<code>[&gt;0];[&lt;0];[=0]</code></li>
<li>2个条件区段，并用半角分号(;)间隔;如下：<code>[&gt;0];[&lt;0]</code></li>
<li><strong>自定义条件</strong>:<br>4区段：<code>[条件1];[条件2];[不满足条件的其他部分];[文本]</code>;<br>3区段：<code>[条件1];[条件2];[不满足条件]</code>;<br><code>=TEXT(B2,&quot;[&gt;85]良好;[&gt;75]合格;不合格&quot;)</code><br>2区段：<code>[条件];[不满足条件]</code></li>
<li>实例：<code>=TEXT(TEXT(EDATE(TEXT(A$3,&quot;0!-00&quot;),ROW(A1)-1),&quot;emm&quot;),&quot;[&gt;&quot;&amp;A$6&amp;&quot;] ;0&quot;)</code>;EDATE计算出”2011-09”以后的指定月份的日期，然后根据ROW(A1)-1来生成来连续的区间的月份。<br><img src="/img/other/text生产指定区间的日期.png" alt="text"> </li>
<li>利用TEXT函数将日期转换成为中文格式的月份：<code>=TEXT(A2,&quot;[DBnum1]m月&quot;)</code>  格式有yyyymmdd</li>
<li>TEXT格式化代码： 0代表原先值，!0代表0；<br>WEEKDAY函数算出是周几,然后减5,周六/日则为1，2；否则负数和0强制为0，以下为实现函数公式:<br><code>TEXT(WEEKDAY(DATE(2016,A3,20),2)-5,&quot;0;!0;!0&quot;)</code></li>
</ul>
</li>
<li>逻辑判断：AND、OR与OR函数，例如<code>=IF(AND(B2=&quot;一线&quot;, c2&gt;10), &quot;是&quot;,&quot;否&quot;)</code>注意逻辑函数的写法</li>
<li>常用的IS函数：<ul>
<li>ISBLANK函数：是否空格</li>
<li>ISERROR函数：值为任意错误值</li>
<li>ISNA函数：值为#N/A错误值</li>
<li>ISNUMBER函数：值为数值</li>
<li>ISNONTEXT函数：值为不是文本的任一项</li>
<li>ISTECT函数：值为文本</li>
<li>ISEVEN函数：数字为偶数</li>
<li>ISODD函数：数字为奇数</li>
</ul>
</li>
<li>转换和公约/倍数:<ul>
<li>弧度和角度转换：a. 弧度转化为角度：DEGREES(angle)  b. 角度转化为弧度：RADIANS(angle)</li>
<li>最大公约数：<code>GCD(number1,[number2],..)</code></li>
<li>返回两个或多个整数的最大公约数、最小公倍数:<code>LCM(number1,[number2],..)</code></li>
<li>返回两个或多个整数的最小公倍数： MOD 取余函数<code>MOD(number,divisor)</code></li>
</ul>
</li>
<li><p>取舍函数：CEILING函数：向上舍入；FLOOR函数：向下舍去；注意：这两个函数都是按照舍入基数的整数倍进行取舍；格式如下：significance为舍入基数</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">CEILING</span><span class="params">(number,[significance])</span></span></span><br><span class="line"><span class="function"><span class="title">FLORR</span><span class="params">(number,[significance])</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>判断是否为闰年：转换成日期的年份，与字符串”-2-29”连接，生产”2014-2-29”样式的字符串，如果该日期不存在，则将会按文本进行处理。字符串前加上负号，如果字符串是日期，则返回一个负数，否则返回错误值”#CALUE!”。在用<strong>COUNT</strong>判断是否为数字，如果是则为闰年，否则平年。</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IF(<span class="name">COUNT</span>(<span class="name">-</span>(<span class="name">YEAR</span>(<span class="name">A2</span>)&amp;<span class="string">"-2-29"</span>)),<span class="string">"闰年"</span>,<span class="string">"平年"</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>日期函数：</p>
<ul>
<li>计算指定月份的日期：开始日期之后几个月的日期<code>EDATE(start_date, months)</code></li>
<li>EOMONTH 函数返回指定月数之前或者之后的最后一天的日期。DAY返回某个日期在一个月的天数。 例子：计算本月总天数<code>=DAY(EOMONTH(TODAY(),0))</code></li>
<li><p>DATEIF函数：计算两个日期之间的天数、月数或者年数</p>
  <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">DATEDIF</span><span class="params">(start_date, end_date, unit)</span></span></span><br><span class="line">#unit：Y-年，M-月，D-天数，MD日期中的天数差-忽略年月，YM日期中的月数差-忽略日年，YD日期中的天数差，忽略年</span><br></pre></td></tr></table></figure>
</li>
<li><p>DATESTRING函数：返回指定日期的中文短日期</p>
</li>
<li>星期相关函数：WEEKDAY函数返回某个日期的一周中的第几天。<br>  <code>WEEKDAY(serial_number,[return_type])</code>:return_type: 1-默认/数字1(星期日)~7(星期六); 2-数字0(一)~7(日)</li>
<li><p>TEXT函数第二参数：</p>
  <figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">= <span class="built_in">TEXT</span>(<span class="symbol">B1</span>, <span class="string">"aaaa"</span>) #返回中文如<span class="string">"星期六"</span></span><br><span class="line">= <span class="built_in">TEXT</span>(<span class="symbol">B1</span>, <span class="string">"aaa"</span>)  #返回中文星期简写如<span class="string">"六"</span></span><br><span class="line">= <span class="built_in">TEXT</span>(<span class="symbol">B1</span>, <span class="string">"dddd"</span>) #返回英文<span class="string">"Saturday"</span></span><br><span class="line">= <span class="built_in">TEXT</span>(<span class="symbol">B1</span>, <span class="string">"ddd"</span>)  #返回英文<span class="string">"Sat"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>WEEKNUM函数：返回指定日期属于全年的第几周 <code>WEEKNUM(serial_number, [return_type])    #return_type默认为2</code></p>
</li>
</ul>
</li>
<li><p>使用数组公式：判断日期所在月份有几个星期日<br><strong>数组公式</strong>：不用填入<code>{}</code>;F2进入编辑，编辑好后，再使用<code>&lt;Ctrl+Shift+Enter&gt;</code>进行数组公式计算。<br>a) 首先提取出年月，使用&amp;拼接出<code>{2015-2-1,2015-2-2...,2015-2-31}</code>数组。<br>b) 使用MOD函数除以7，周日的情况下为1。如果对于2015-2-30等不存在的日期则会返回错误值。<br>c) 最后=1则周日情况下返回TRUE，否则(包括不等于1和错误值)则为0或者错误值。0除以TRUE为0，其他返回错误值#DIV/0！或者#VALUE！。<br>d) 最后COUNT函数统计结果。 公式如下：<br><code>=COUNT(0/(MOD(TEXT(A2,&quot;e-m&quot;)&amp;-ROW($1:$31),7)=1))</code><br><img src="/img/other/判断日期所在月份有几个星期日.png" alt="星期使用函数"></p>
</li>
<li><p>LOOKUP函数：查询列表中小与或者等于目标值的最大值匹配，然后在第三参数中相同位置的值</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">LOOKUP</span><span class="params">(lookup_value,lookup_vector,[result_vector])</span></span></span><br><span class="line">#lookup_vector查询范围，result_vector第三参数中对应的位置的值</span><br><span class="line"><span class="function"><span class="title">LOOKUP</span><span class="params">(lookup_value,array)</span></span></span><br></pre></td></tr></table></figure>
<p>返回A列最后一个非空单元格内容</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=<span class="built_in">LOOKUP</span>(<span class="number">1</span>,<span class="number">0</span>/(<span class="symbol">A:A</span>&lt;&gt;<span class="string">""</span>),<span class="symbol">A:A</span>)</span><br><span class="line">#本写法就构建一个由<span class="number">0</span>和错误值#DIV/!组成的数组，再用比<span class="number">0</span>大的<span class="number">1</span>作为查找值，即可查找结果区域中最后一个满足条件的记录。</span><br><span class="line">#经典用法：=<span class="built_in">LOOKUP</span>(<span class="number">1</span>,<span class="number">0</span>/(条件),目标区域或数组)</span><br></pre></td></tr></table></figure>
</li>
<li><p>INDIRECT引用函数： <code>INDIRECT(ref_text,[a1])</code> 注: ref_text可以是文本，也可以是不同区域，例如<code>INDIRECT({&quot;C1:C10&quot;,&quot;F2:F10&quot;})</code></p>
</li>
<li>返回指定单元格/区域的行号ROW() 和列号COLUMN()</li>
<li><p>基本查找函数VLOOKUP：查询值要求必须位于查询区域中的首列</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">VLOOKUP(lookup_value,table_array,col_index_num,[rank_lookup])</span><br><span class="line"><span class="meta">#</span><span class="bash"> 第一参数查找值，第二参数查找区域</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 第三参数指定返回查询区域中的第几列值，超过查询列的总列数，将返回错误值<span class="comment">#REF，小于1返回错误值#VALUE</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 第四参数，0或FASLE为精确匹配方式，支持无序查找；1或者TRUE或省略，则使用的近似匹配方式，同时要求查询区域的首列按升序排序</span></span><br></pre></td></tr></table></figure>
<p>VLOOKUP一些技巧：</p>
<pre><code>a) 逆向查询，通过CHOOSE函数绕开查询值位于查询区域的首列：``=VLOOKUP(F5,CHOOSE({1,2},D2:D10,B2:B10),2,0)``
    CHOOSE函数使用常量数组{1,2}将查询值所在的D2:D10和返回值B2：B10整合成一个新的两列多行的内存数组
    CHOSSE可以根据指定数字序号返回与其对应的数据值结果
b) 使用数组查询多个内容：选中结果区域``=VLOOKUP(G2,A:E,{3,5},)}`` 然后``&lt;Ctrl+Shift+Enter&gt;``
</code></pre></li>
<li>MATCH函数：在单元格区域中搜索指定项，返回该项在单元格区域中的相对位置<code>MATCH(lookup_value,lookup_array,[match_type])</code><br>match_type第三参数，0、1或者省略、-1分别代表精确匹配或者升序查找，降序查找模型</li>
<li><p>COUNT函数：<code>COUNT(value1,[..value2]..</code>用于计算包含数字的单元格以及参数列表中数字的个数<br>COUNT实例-计算考核得分大于等于3的达标率</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;=TEXT(<span class="name">COUNT</span>(<span class="number">0</span>/(<span class="name">C2:C11&gt;=3</span>))/COUNT(<span class="name">C2:C11</span>),<span class="string">"0.00%"</span>)&#125;</span><br></pre></td></tr></table></figure>
<p>计算范围中不为空的单元格个数<code>COUNTNTA(value1,[value2],..)</code><br>计算空白单元格个数<code>COUNTBLANK(range)</code><br>判断某一年是否是闰年和平年 <code>IF(COUNT(-(YEAR(A2)&amp;&quot;-2-29&quot;)),&quot;闰年&quot;,&quot;平年&quot;)</code></p>
</li>
<li><p>COUNTIF函数：统计满足条件的单元格的数量<code>COUNTIF(range,criteria)</code>, criteria可以使用通配符？-任意单个字符，*任何字符；如果要查找问号或星号，则在字符前输入波浪符号”~”,如：<code>~？</code><br>例子:检查重复身份证号码</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=<span class="built_in">IF</span>(<span class="built_in">COUNTIF</span>(B$<span class="symbol">2:B</span>$<span class="number">11</span>,<span class="symbol">B2</span>&amp;<span class="string">"*"</span>)&gt;<span class="number">1</span>,<span class="string">"是"</span>,<span class="string">""</span>)</span><br><span class="line">#excel的数字精度为<span class="number">15</span>位，而身份证位<span class="number">18</span>位，后<span class="number">3</span>位视为<span class="number">0</span>，所以<span class="built_in">COUNTIF</span>函数的cirteria部分使用<span class="symbol">B2</span>&amp;<span class="string">""</span>,转化为文本格式。</span><br></pre></td></tr></table></figure>
</li>
<li><p>频数统计函数FREQUENCY：统计数值在某个区域内的出现平吕，返回一个垂直数组</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FREQUENCY(data_array,bins_array)</span><br><span class="line"><span class="meta">#</span><span class="bash">data_array一组数值或者数值引用</span></span><br><span class="line"><span class="meta">#</span><span class="bash">bins_array间隔数组，可以无序，统计是按照间隔点的数值升序排列</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>众数MODE函数<br>均值函数AVERAGE函数<br>数组中对应元素相乘SUMPRODUCT函数：<code>SUMPRODUCT(array1,[array2],[array3],...)</code><br>求和函数SUM，同理也有SUMIF函数</p>
</li>
</ol>
<h4 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h4><ol>
<li>Ctrl+1打开单元格格式 </li>
<li>Ctrl+L /Ctrl+T创建表格，这里指套用格式。</li>
<li>Alt+= 自动求和</li>
<li>Ctrl+`(在Tab键之上)组合键可以直接显示公式和普通模式的切换</li>
<li>使用名称：公式-&gt;名称管理器 或者 Ctrl+F3</li>
</ol>
<hr>
<p>2018年2月22日完</p>
<blockquote>
<p>《Excel 函数与公式应用大全》</p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>
  
        <div class="post-tags">
          
            <a href="/tags/excel/" rel="tag"># excel</a>
          
        </div>
      
  <div>
    
      


     <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
     <div style="text-align:center;font-size:14px;font-weight:blod"><i class="fa fa-copyright"></i>友情提示: 转载请保留原文链接及作者。</div>
<br/>

    
  </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>🐶 您的支持将鼓励我继续创作 🐶</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赞赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat-reward-img.jpg" alt="Shuangquan WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="/images/alipay-reward-img.jpg" alt="Shuangquan Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
         
      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/金融模型-评分卡（一）.html" rel="next" title="金融模型-评分卡（一）">
                <i class="fa fa-chevron-left"></i> 金融模型-评分卡（一）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/01/SQL优化技巧总结.html" rel="prev" title="SQL优化技巧总结">
                SQL优化技巧总结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_tqq"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_kaixin001"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMjkxNS85NDc2"></div>
    
	
  </div>



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Shuangquan" />
          <p class="site-author-name" itemprop="name">Shuangquan</p>
          <p class="site-description motion-element" itemprop="description">人生若只如初见，希望它能记录美好的瞬间。youtumi</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/youtumi" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://weibo.com/u/2102131032" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/Itoyou" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-battery-3"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#excel技巧"><span class="nav-number">1.</span> <span class="nav-text">excel技巧</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#常用函数"><span class="nav-number">2.</span> <span class="nav-text">常用函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#快捷键"><span class="nav-number">3.</span> <span class="nav-text">快捷键</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shuangquan</span>
</div>
 <!--以下3行为一条竖线和Coding Page-->
  <div class="powered-by">  
  <span>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></span>
  </div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">
    NexT.Mist
  </a>
</div>


        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  




  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  




   
     
   
  
       <!-- UY BEGIN -->
       <script type="text/javascript">
          (function(d, s) {
              var j, e = d.getElementsByTagName(s)[0];
              if (typeof LivereTower === 'function') { return; }
              j = d.createElement(s);
              j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
              j.async = true;
              e.parentNode.insertBefore(j, e);
          })(document, 'script');
       </script>
       <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
       <!-- UY END -->
   
 

  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


</body>
</html>
